<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>test</title>
        <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
        <script type="text/javascript" src="./lufylegend-1.10.1.js"></script>
        <script type="text/javascript" src="./lufylegend.ui-0.14.1.min.js"></script>
    </head>
    <body style="margin:0;padding:0;">
        <div id="legend">
        </div>
        <script type="text/javascript">
            init(1000/60,"legend",800,600,gameInit);
            
            var cou = 1;

        function gameInit(){
            LPurchaseInit();
            
            var backLayer = new LSprite();
            addChild(backLayer);
            var button01 = new LButtonSample1("Se_ok");
            button01.x = 50;
            button01.y = 50;
            backLayer.addChild(button01);
            button01.addEventListener(LMouseEvent.MOUSE_DOWN,function(e){
                LPlugin.playSE("Se_ok",(cou++) % 2 == 0 ? 1 : 0.2);
            });
                                      
            var button02 = new LButtonSample1("battle1");
            button02.x = 50;
            button02.y = 100;
            backLayer.addChild(button02);
            button02.addEventListener(LMouseEvent.MOUSE_DOWN,function(e){
                LPlugin.playBGM("battle1",1);
            });
            
            var button03 = new LButtonSample1("purchaseLog");
            button03.x = 50;
            button03.y = 150;
            backLayer.addChild(button03);
            button03.addEventListener(LMouseEvent.MOUSE_DOWN,function(e){
                                      var purchase = LPurchase.Instance();
                                      purchase.addEventListener(LPurchase.PURCHASE_LOG_COMPLETE,function(event){
                                                                var data = event.target;
                                                                var in_app = data.receipt.in_app;
                                                                LPlugin.print("in_app " + (in_app.length));
                                                                LPlugin.print("in_app " + (in_app[0].product_id));
                                                                });
                purchase.purchaseLog();
            });
            
            var button04 = new LButtonSample1("productInformation");
            button04.x = 50;
            button04.y = 200;
            backLayer.addChild(button04);
            button04.addEventListener(LMouseEvent.MOUSE_DOWN,function(e){
                var purchase = LPurchase.Instance();
                purchase.addEventListener(LPurchase.PRODUCT_INFORMATION_COMPLETE,function(event){
                    var data = event.target;
                    for(var i=0;i<data.length;i++){
                        LPlugin.print("data= " + (data[i].title));
                        LPlugin.print("priceLabel= " + (data[i].priceLabel));
                        LPlugin.print("price= " + (data[i].price));
                        LPlugin.print("productId= "+(data[i].productId));
                    }
                });
                purchase.productInformation(["newWujiang","saveReport","com.lufylegend.sgj.id01"]);
            });
            
            var button05 = new LButtonSample1("purchase");
            button05.x = 50;
            button05.y = 250;
            backLayer.addChild(button05);
            button05.addEventListener(LMouseEvent.MOUSE_DOWN,function(e){
                                      var purchase = LPurchase.Instance();
                                      purchase.addEventListener(LPurchase.PURCHASE_COMPLETE,function(event){
                                                                if(event.status == 0){
                                                                LPlugin.print("event.message= " + (event.message));
                                                                return;
                                                                }
                                                                var data = event.target;
                                                                LPlugin.print("data= " + data);
                                                                });
                                      purchase.purchase("com.lufylegend.sgj.id01");
                                      });


        }
        </script>
    </body>
</html>
